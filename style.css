/* =========================================
   1. RESET & GLOBAL STYLES
   ========================================= */
html {
    scroll-behavior: smooth;
}

/* HOME PAGE STYLES */
.home-container {
    max-width: 900px;
    margin: 20px auto;
    padding: 20px;
    background-color: #fff;
    border: 1px solid #d9bfb7;
    box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
}

.welcome-section { text-align: center; border-bottom: 2px solid #af0a0a; padding-bottom: 10px; }

.instruction-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 20px;
}

.ins-card {
    background: #f0e0d6;
    padding: 15px;
    border: 1px solid #d9bfb7;
}

.home-links a {
    display: block;
    font-size: 1.2em;
    font-weight: bold;
    margin: 8px 0;
    padding: 5px;
    border-bottom: 1px solid #ccc;
}

.rules-box {
    margin-top: 20px;
    padding: 15px;
    border: 2px dashed #af0a0a;
    font-size: 0.9em;
}

/* THE HIDDEN LINK */
.footer-secret { text-align: center; margin-top: 50px; }
.secret-link { color: #f0f0f0; text-decoration: none; font-size: 10px; transition: color 0.5s; }
.secret-link:hover { color: #888; } /* Only becomes visible on hover */

/* NIGHT MODE HOME */
body.night-mode .home-container { background-color: #2b2b2b; color: #ccc; border-color: #444; }
body.night-mode .ins-card { background: #333; border-color: #555; }

body {
    background-color: #ffe;
    color: #800000;
    font-family: arial, helvetica, sans-serif;
    font-size: 10pt;
    margin: 0;
    padding: 10px;
}

a { color: #0000ee; text-decoration: none; cursor: pointer; }
a:hover { color: #d00; }

hr { border: 0; border-bottom: 1px solid #d9bfb7; }

/* =========================================
   2. HEADER & NAVIGATION
   ========================================= */
.header { text-align: center; margin-bottom: 20px; }
.header h1 { color: #af0a0a; font-size: 24px; margin: 5px; }

/* =========================================
   3. POST FORM
   ========================================= */
.post-box {
    background-color: #f0e0d6;
    border: 1px solid #d9bfb7;
    width: 468px;
    margin: 0 auto;
    padding: 5px;
    display: table; 
}
.form-header {
    background-color: #e04000;
    color: white;
    font-weight: bold;
    text-align: center;
    padding: 2px;
}
form { display: flex; flex-direction: column; gap: 5px; padding: 10px; }
input, textarea { width: 98%; border: 1px solid #ccc; padding: 2px; }
textarea { height: 80px; resize: vertical; }

#uploadBtn {
    background-color: #4CAF50; /* Green for "Upload" */
    color: white;
    border: 1px solid #3d8b40;
    cursor: pointer;
    font-size: 0.85em;
    border-radius: 3px;
}

#uploadBtn:hover {
    background-color: #45a049;
}

#uploadBtn:disabled {
    background-color: #ccc;
    cursor: wait;
}

/* Night Mode version */
body.night-mode #uploadBtn {
    background-color: #2e7d32;
    border-color: #1b5e20;
}

/* =========================================
   4. THREAD CARD LAYOUT
   ========================================= */
.thread-card {
    background-color: #fff;
    border: 1px solid #d9bfb7;
    padding: 10px;
    margin-bottom: 25px;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.05);
    overflow: hidden;
    max-width: 850px; 
    width: auto; 
}

/* Header Row */
.thread-card .post-info {
    display: block;
    width: 100%;
    border-bottom: 1px solid #eee;
    padding-bottom: 5px;
    margin-bottom: 10px;
    background-color: transparent;
}

/* Content Area */
.post-content {
    display: block;
    min-height: 80px;
}

/* Reply Button */
.reply-link {
    float: right;
    font-size: 0.8em;
    font-weight: bold;
    margin-left: 10px;
    background-color: #f0f0f0;
    color: #555;
    padding: 2px 8px;
    border: 1px solid #ccc;
    border-radius: 3px;
}

/* Thread Summary Footer */
.thread-summary {
    clear: both;
    display: block;
    margin-top: 15px;
    padding-top: 5px;
    border-top: 1px dotted #ccc;
    font-size: 0.85em;
    color: #555;
}
.reply-count-num { font-weight: bold; color: #af0a0a; }

/* =========================================
   5. REPLIES LAYOUT
   ========================================= */
.reply {
    background-color: #f0e0d6;
    border: 1px solid #d9bfb7;
    margin: 5px 0 5px 20px;
    padding: 8px;
    display: table;
    max-width: 800px;
    min-width: 350px;
    overflow: hidden; /* CLEARFIX: Forces box to contain the floated image */
}

.reply .post-info {
    display: block;
    background-color: transparent;
    border-bottom: none;
    margin-bottom: 5px;
    padding: 0;
}

/* =========================================
   6. TEXT & METADATA
   ========================================= */
.subject { color: #cc1105; font-weight: bold; font-size: 1.1em; margin-right: 5px; }
.name { color: #117743; font-weight: bold; margin-right: 5px; }
.time { color: #555; font-size: 0.9em; margin-right: 5px; }
.post-id { color: #555; cursor: pointer; font-size: 0.9em; }
.post-id:hover { color: #d00; }

.comment { 
    margin-left: 10px; 
    word-wrap: break-word; 
    white-space: pre-wrap; 
    line-height: 1.4;
}

.quote-link { color: #d00; text-decoration: underline; cursor: pointer; }
.backlink-container { font-size: 0.75em; margin-top: 8px; color: #dd0000; }
.backlink { color: #dd0000; text-decoration: underline; margin-right: 5px; }

/* =========================================
   7. MEDIA (IMAGES & VIDEOS) - GLOBAL FIX
   ========================================= */
.thread-image, .media-container {
    float: left;
    margin: 0 15px 10px 0;
    position: relative;
    cursor: pointer;
    border: 2px solid #000055;
    line-height: 0;
    display: inline-block;
}

/* Force all thumbnails to stay within 200px limit */
.thread-image, 
.media-container img {
    display: block;
    max-width: 200px !important;
    max-height: 200px !important;
    width: auto;
    height: auto;
}

.play-overlay {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.6);
    color: white; font-size: 30px;
    width: 50px; height: 50px;
    text-align: center; line-height: 50px;
    border-radius: 50%; pointer-events: none;
    z-index: 2;
}

.file-placeholder {
    width: 200px; height: 150px;
    background: #000; color: #fff;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
}
.file-ext { font-weight: bold; font-size: 24px; color: #ffcc00; }

/* X (Twitter) Placeholder Styling */
.x-placeholder {
    background-color: #000; /* Dark background like X */
    border: 2px solid #1DA1F2; /* Twitter Blue accent */
}

/* Adjust Iframe size for X posts which are usually tall */
body.night-mode #lbFrame {
    background-color: #000;
}

/* Lightbox */
#lightbox {
    display: none; position: fixed; z-index: 1000;
    left: 0; top: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.85);
    justify-content: center; align-items: center;
}
#lightboxContent {
    max-width: 95%; max-height: 95%;
    display: flex; justify-content: center; align-items: center;
    width: 100%; height: 100%;
}
#lightbox img { max-width: 90%; max-height: 90%; border: 2px solid white; }
#lbVideo, #lbFrame { max-width: 90vw; max-height: 90vh; background: black; }
#lbFrame { width: 800px; height: 450px; }

/* =========================================
   8. ADMIN TOOLS
   ========================================= */
.admin-delete-btn {
    display: none;
    color: red; font-weight: bold;
    margin-left: 10px; cursor: pointer;
    font-size: 0.8em;
}
.mod-mode-active .admin-delete-btn { display: inline-block; }

/* =========================================
   9. NIGHT MODE (NSFW / DARK)
   ========================================= */

#nsfwGate {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: #1a1a1a; /* Always dark for the gate */
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    text-align: center;
}

.gate-box {
    background: #2b2b2b;
    padding: 30px;
    border: 2px solid #900;
    border-radius: 8px;
    max-width: 400px;
}

.gate-buttons {
    margin-top: 20px;
    display: flex;
    gap: 10px;
    justify-content: center;
}

.btn-enter { background: #900; color: white; border: none; padding: 10px 20px; cursor: pointer; font-weight: bold; }
.btn-exit { background: #444; color: white; border: none; padding: 10px 20px; cursor: pointer; }

/* Ensure the board is hidden when gate is up */
body.gate-active #boardView, 
body.gate-active #threadView,
body.gate-active .header,
body.gate-active .post-box {
    display: none !important;
}

body.night-mode {
    background-color: #1a1a1a;
    color: #cccccc;
}

body.night-mode a { color: #8cbaff; } 
body.night-mode a:hover { color: #ff6666; }

body.night-mode .thread-card,
body.night-mode .reply,
body.night-mode .post-box {
    background-color: #2b2b2b;
    border-color: #444;
    color: #ddd;
}

body.night-mode .post-info { border-bottom-color: #444; }

body.night-mode input,
body.night-mode textarea {
    background-color: #333; color: white; border: 1px solid #555;
}
body.night-mode .form-header { background-color: #900; }

body.night-mode .subject { color: #ff8888; }
body.night-mode .name { color: #88ff88; }
body.night-mode .post-id { color: #888; }
body.night-mode .reply-link { background-color: #444; border-color: #555; color: #aaa; }
body.night-mode .reply-link:hover { background-color: #555; color: #fff; }

/* =========================================
   NSFW THUMBNAIL BLUR (AUTO-BLUR)
   ========================================= */

/* 1. Apply blur to thumbnails in night-mode (NSFW boards) */
body.night-mode .thread-image,
body.night-mode .media-container img,
body.night-mode .file-placeholder {
    filter: blur(25px); /* Strong blur */
    transition: filter 0.3s ease, transform 0.3s ease;
    opacity: 0.7; /* Slightly faded */
}

/* 2. Reveal on Hover (For PC Users) */
body.night-mode .thread-image:hover,
body.night-mode .media-container:hover img,
body.night-mode .media-container:hover .file-placeholder {
    filter: blur(0);
    opacity: 1;
    transform: scale(1.02); /* Slight zoom to show it's active */
}

/* 3. Handle the Play Overlay (YouTube/Video) */
/* We hide the play button until hovered so it doesn't look messy over the blur */
body.night-mode .media-container .play-overlay {
    opacity: 0;
    transition: opacity 0.3s ease;
}

body.night-mode .media-container:hover .play-overlay {
    opacity: 1;
}

/* 4. IMPORTANT: Ensure the Lightbox is NOT blurred */
#lightbox img, 
#lbVideo, 
#lbFrame {
    filter: blur(0) !important;
    opacity: 1 !important;
}

/* =========================================
   10. MOBILE RESPONSIVENESS
   ========================================= */
@media (max-width: 768px) {
    .thread-card {
        max-width: 100%;
        margin-left: -10px;
        margin-right: -10px;
        border-left: none;
        border-right: none;
        padding: 8px;
    }
    
    .reply {
        margin-left: 10px;
        max-width: 95%;
        min-width: unset; /* Allow it to shrink on small phones */
    }

    .post-box {
        width: 95%;
    }

    .thread-image, .media-container {
        max-width: 150px; /* Smaller thumbnails on mobile */
    }
}